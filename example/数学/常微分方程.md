## 一阶微分方程的求解
### 一阶线性微分方程
一阶线性微分方程的一般形式是
$$\dfrac{\text{d}y}{\text{d}x}=p(x)y+q(x)$$
其中$p(x)$和$q(x)$是定义在区间$I=(a,b)$上已知的连续函数。当$q(x)\not\equiv 0$时，方程称为**一阶线性非齐次微分方程**；当$q(x)\equiv 0$时，方程称为**一阶线性齐次微分方程**。
#### 一阶线性齐次微分方程
一阶线性齐次微分方程为
$$\dfrac{\text{d}y}{\text{d}x}=p(x)y$$
它的通解可表示为
$$y(x)=Ce^{\int p(x)\text{d}x}$$
对于初值问题
$$\dfrac{\text{d}y}{\text{d}x}=p(x)y,\quad y(x_0)=y_0$$
满足初值的特解为
$$y(x)=y_0e^{\int_{x_0}^xp(t)\text{d}t}$$
#### 一阶线性非齐次微分方程
考虑一阶线性非齐次微分方程
$$\dfrac{\text{d}y}{\text{d}x}=p(x)y+q(x)$$
其中$p(x)$和$q(x)$是定义在区间$I=(a,b)$上已知的连续函数且$q(x)\not\equiv 0$。
在方程的两边同时乘积分因子$e^{-\int p(x)\text{d}x}$，则原ODE等价为
$$\dfrac{\text{d}}{\text{d}x}\left(e^{-\int p(x)\text{d}x}y\right)=e^{-\int p(x)\text{d}x}q(x)$$
因此
$$e^{-\int p(x)\text{d}x}y=\int q(x)e^{-\int p(x)\text{d}x}\text{d}x+C$$
由此得到一阶线性非齐次微分方程的通解为
$$y(x)=e^{\int p(x)\text{d}x}\left(C+\int q(x)e^{-\int p(x)\text{d}x}\text{d}x\right)$$
对于初值问题
$$\dfrac{\text{d}y}{\text{d}x}=p(x)y+q(x),\quad y(x_0)=y_0$$
满足初值的特解可表示为
$$y(x)=e^{\int_{x_0}^xp(t)\text{d}t}\left(y_0+\int_{x_0}^xq(s)e^{-\int_{x_0}^sp(t)\text{d}t}\text{d}s\right)$$
### 标准形式的一阶非线性微分方程
#### 变量分离方程
考虑形如
$$\dfrac{\text{d}y}{\text{d}x}=f(x)g(y)$$
的方程，通常称为**变量分离方程**，其中$f(x)$是定义在$I_x=(a,b)$上的连续函数，$g(y)$是定义在$I_y=(c,d)$的连续函数。
由Picard存在唯一性定理，对于区域$G=I_x\times I_y$中的每一点$(x_0,y_0)$，上述方程有且只有一个以它为初值的解。
若$g(y_0)\neq 0$，原ODE可化为
$$\dfrac{\text{d}y}{g(y)}=f(x)\text{d}x$$
这里由于Picard存在唯一性定理，$g(y)\neq 0,\quad \forall y\in I_y$，否则存在两个解。
令$G(y,y_0)=\int_{y_0}^y\dfrac{\text{d}\xi}{g(\xi)}$，则原ODE可化为
$$G(y,y_0)=\int_{x_0}^xf(t)\text{d}t$$
因此原ODE初值问题的解为
$$y(x)=G^{-1}(\int_{x_0}^xf(t)\text{d}t,y_0)$$
#### 齐次方程
如果函数$f(x,y)$是关于变量$x,y$的零次齐次函数，即对$t\in\mathbb{R}\backslash\{0\}$，满足
$$f(tx,ty)=f(x,y)$$
则称ODE$$\dfrac{\text{d}y}{\text{d}x}=f(x,y)$$为**齐次型方程**，简称**齐次方程**。
对零次齐次函数，有
$$f(x,y)=f(1,\dfrac{y}{x})\triangleq g(\dfrac{y}{x})$$
因此可以将原ODE化为
$$\dfrac{\text{d}y}{\text{d}x}=g(\dfrac{y}{x})$$
记$u=\dfrac{y}{x}$，则
$$\dfrac{\text{d}y}{\text{d}x}=x\dfrac{\text{d}u}{\text{d}x}+u$$
因此原ODE可化为
$$x\dfrac{\text{d}u}{\text{d}x}=f(1,u)-u$$
**例1：** 求解ODE
$$\dfrac{\text{d}y}{\text{d}x}=\dfrac{3x^2+y^2-6x+4y+7}{2xy+4x-2y-4}$$
*解：* 原ODE化为
$$\dfrac{\text{d}y}{\text{d}x}=\dfrac{3(x-1)^2+(y+2)^2}{2(x-1)(y+2)}$$
取
$$u=\dfrac{y+2}{x-1}$$
则原ODE化为
$$(x-1)\dfrac{\text{d}u}{\text{d}x}+u=\dfrac{3+u^2}{2u}$$
分离变量得
$$\dfrac{2u}{3-u^2}\text{d}u=\dfrac{\text{d}x}{x-1}$$
两侧积分得
$$-\ln|3-u^2|=\ln|x-1|+C$$
因此
$$u^2=3-\dfrac{C}{x-1}$$
故ODE的通解为
$$3(x-1)^2-C(x-1)-(y+2)^2=0$$
**例2：** 求解微分方程
$$y^2(x\text{d}x+y\text{d}y)+x^2(y\text{d}x-x\text{d}y)=0$$

*解：* 原ODE可化为
$$\dfrac{\text{d}y}{\text{d}x}=\dfrac{xy^2+x^2y}{x^3-y^3}$$
这是一个齐次型方程，令$u=\dfrac{y}{x}$，则
$$x\dfrac{\text{d}u}{\text{d}x}+u=\dfrac{u^2+u}{1-u^3}$$
因此
$$x\dfrac{\text{d}u}{\text{d}x}=\dfrac{u^2(1-u^2)}{1-u^3}=\dfrac{u^2(1+u)}{u^2+u+1}$$
分离变量得
$$\int\dfrac{u^2+(1+u)}{u^2(1+u)}\text{d}u=\int\dfrac{1}{x}\text{d}x+C$$
即
$$\int\dfrac{\text{d}u}{1+u}+\int\dfrac{\text{d}u}{u^2}=\int\dfrac{1}{x}\text{d}x+C$$
故原ODE的解为
$$x+y=Cx^2e^{\frac{x}{y}}$$
#### 恰当方程
设$G$是平面$\mathbb{R}^2$中的一个区域，若在区域$G$内存在一个具有一阶连续偏导数的二元函数$F(x,y)$使得
$$\text{d}F(x,y)=M(x,y)\text{d}x+N(x,y)\text{d}y$$
则称一阶微分方程
$$M(x,y)\text{d}x+N(x,y)\text{d}y=0$$
为区域$G$内的**恰当方程**，也称它为**全微分方程**。
**定理：** 设函数$M(x,y)$和$N(x,y)$在单连通区域$G\subset \mathbb{R}^2$上连续且有连续的一阶偏导数$\dfrac{\partial M}{\partial y}$与$\dfrac{\partial N}{\partial x}$，则微分方程
$$M(x,y)\text{d}x+N(x,y)\text{d}y=0$$
是恰当方程的充要条件是
$$\dfrac{\partial M}{\partial y}=\dfrac{\partial N}{\partial x},\quad (x,y)\in G$$
这时恰当方程在$G$上的通解为
$$\int_{x_0}^xM(x,y)\text{d}x+\int_{y_0}^yN(x_0,y)\text{d}y=C$$
或
$$\int_{x_0}^xM(x,y_0)\text{d}x+\int_{y_0}^yN(x,y)\text{d}y=C$$
其中$(x_0,y_0)$是$G$中任意固定的点。
#### 积分因子法
如果存在非零因子$\mu(x,y)$使得方程
$$\mu(x,y)M(x,y)\text{d}x+\mu(x,y)N(x,y)\text{d}y=0$$
成为一个恰当方程，则称$\mu(x,y)$为方程
$$M(x,y)\text{d}x+N(x,y)\text{d}y=0$$
的一个**积分因子**。
**定理：** 方程$M(x,y)\text{d}x+N(x,y)\text{d}y=0$存在仅含$x$的积分因子$\mu(x)$的充分必要条件为
$\dfrac{\partial M/\partial y-\partial N/\partial x}{N}$是一个仅与$x$有关的函数。若记这个仅与$x$有关的函数为$g(x)$，则积分因子$\mu(x)$可取为$\mu(x)=e^{\int g(x)\text{d}x}$。
> 对$y$同理可推广类似的结论。

**常用微分公式：**
$$\text{d}(\dfrac{y}{x})=\dfrac{x\text{d}y-y\text{d}x}{x^2}$$
$$\text{d}(\dfrac{x}{y})=\dfrac{y\text{d}x-x\text{d}y}{y^2}$$
$$\text{d}(\arctan\dfrac{x}{y})=\dfrac{y\text{d}x-x\text{d}y}{x^2+y^2}$$
$$\text{d}(\ln\dfrac{x}{y})=\dfrac{y\text{d}x-x\text{d}y}{xy}$$
**例：** 求解微分方程
$$\left(\dfrac{y}{x}+3x^2\right)\text{d}x+\left(1+\dfrac{x^3}{y}\right)\text{d}y=0$$
*解：* 把方程重写为
$$\dfrac{y}{x}\text{d}x+\text{d}y+3x^2\text{d}x+\dfrac{x^3}{y}\text{d}y=0$$
显然，方程$\dfrac{y}{x}\text{d}x+\text{d}y=0$有积分因子$\mu_1=x$和通解$\Phi_1(x,y)=xy=C_1$；方程$3x^2\text{d}x+\dfrac{x^3}{y}\text{d}y=0$有积分因子$\mu_2=y$和通解$\Phi_2(x,y)=x^3y=C_2$。为求得两个可微函数$g_1$和$g_2$使得
$$xg_1(xy)=yg_2(x^3y)$$
可以令$g_1(t)=t^\alpha,g_2(t)=t^\beta$，则
$$x(xy)^{\alpha}=y(x^3y)^{\beta}$$
待定系数法可以解得$\alpha=2,\beta=1$，因此$\mu=x^3y^2$是原方程的一个积分因子，带入后有
$$x^2y^3\text{d}x+x^3y^2\text{d}y+3x^5y^2\text{d}x+x^6y\text{d}y=0$$
即
$$(x^2y^3+3x^5y^2)\text{d}x+(x^3y^2+x^6y)\text{d}y=0$$
此时可以验证
$$\dfrac{\partial (x^2y^3+3x^5y^2)}{\partial y}=\dfrac{\partial (x^3y^2+x^6y)}{\partial x}=3x^2y^2+6x^5y$$
设原ODE的通解为$F(x,y)=C$，则
$$F(x,y)=\int (x^2y^3+3x^5y^2)\text{d}x+\psi(y)=\dfrac{1}{3}x^3y^3+\dfrac{1}{2}x^6y^2+\psi(y)$$
因此
$$\dfrac{\partial F}{\partial y}=x^3y^2+x^6y+\psi'(y)=x^3y^2+x^6y$$
故$\psi'(y)=0$，即原方程的通解为
$$\dfrac{1}{3}x^3y^3+\dfrac{1}{2}x^6y^2=C$$
#### 几个重要的非线性微分方程
1. Bernoulli方程$$y'+g(x)y+h(x)y^{\alpha}=0\quad (\alpha\neq 0,1)$$其中$g(x)$和$h(x)$都是定义在区间$I=(a,b)$上的连续函数。
	 在方程两边同时乘积分因子$(1-\alpha)y^{-\alpha}$得$$(y^{1-\alpha})'+(1-\alpha)g(x)y^{1-\alpha}+(1-\alpha)h(x)=0$$令$z=y^{1-\alpha}$，则化为一阶线性微分方程。
 2. Riccati方程$$y'+g(x)y+h(x)y^2=k(x)$$其中$g(x)$，$h(x)$和$k(x)$都是定义在区间$I=(a,b)$上的连续函数。
	假设能得到它的一个特解$\phi(x)$，即可构造$u(x)=y(x)-\phi(x)$，使得$u(x)$满足Bernoulli方程，进而可以求解。
### 其他形式的一阶非线性微分方程
#### 参数法
对于一般的一阶ODE
$$F(x,y,y')=0$$
可以通过参数法求解。
基本步骤：
1. 选取曲面$F(x,y,w)=0$的一个参数表示$$x=\varphi(t,s),\quad y=\psi(t,s),\quad w=h(t,s),\quad (s,t)\in G$$即满足$F(\varphi(t,s),\psi(t,s),h(t,s))\equiv 0$；
2. 求解一阶微分方程$\text{d}y=w\text{d}x$，即由$$\text{d}\psi(t,s)=h(t,s)\text{d}\varphi(t,s)$$解得$s=s(t,C)$，其中$C$为任意常数；
3. 由参数方程$$x=\varphi(t,s(t,C)),\quad y=\psi(t,s(t,C))$$所确定的函数关系$y=y(x,C)$即为方程的通解。
#### 可解出$y$的微分方程
对于方程$y=f(x,y')$，记$p=y'$，则可得
$$f'_x(x,p)\text{d}x+f'_p(x,p)\text{d}p=p\text{d}x$$
视情况取$x$或$p$为自变量即可求解该方程，记其通解为$p=w(x,C)$，即可得到方程的通解。
#### 可解出$x$的微分方程
对于方程$x=f(y,y')$，记$p=y'$，则可得
$$f_y'(y,p)\text{d}y+f_p'(y,p)\text{d}p=\dfrac{1}{p}\text{d}y$$
视情况取$y$或$p$为自变量即可求解该方程，记其通解为$p=w(y,C)$，即可得到方程的通解。
**例1：** 求解方程$x^3+y'^3-3xy'=0$。
*解：* $F(x,y,w)=x^3+w^3-3xw$，令$w=tx$，则可解出$x=\dfrac{3t}{1+t^3}$。故参数化表示为
$$x=\dfrac{3t}{1+t^3},\quad y=y,\quad w=\dfrac{3t^2}{1+t^3}$$
由$\text{d}y=w\text{d}x$得
$$\text{d}t=\dfrac{3t^2}{1+t^3}\dfrac{3(t^3+1)-9t^3}{(1+t^3)^2}\text{d}t$$
积分得
$$y=\int\dfrac{9(1-2t^3)t^2}{(1+t^3)^3}\text{d}t=\dfrac{3}{2}\dfrac{1+4t^3}{(1+t^3)^2}+C$$
其中$C$为任意常数。因此原方程的通解为
$$x=\dfrac{3t}{1+t^3},\quad y=\dfrac{3}{2}\dfrac{1+4t^3}{(1+t^3)^2}+C$$
**例2：** 求解微分方程
$$9e^{3y}(y')^2+3xy'-1=0$$
*解1：* 令$p=y'$，则原ODE可写成
$$x=\dfrac{1-9e^{3y}p^2}{3p}$$
则
$$\dfrac{1}{p}\text{d}y=-9e^{3y}p\text{d}y+(-\dfrac{1}{3p^2}-3e^{3y})\text{d}p$$
由于$-\dfrac{1}{3p^2}-3e^{3y}<0$，因此有
$$\dfrac{\text{d}p}{\text{d}y}=\dfrac{\frac{1}{p}+9e^{3y}p}{-\frac{1}{3p^2}-3e^{3y}}=-3p$$
因此可以求出$p=C_1e^{-3y}$，带入原ODE有
$$9e^{3y}C_1^2e^{-6y}+3C_1xe^{-3y}-1=0$$
因此可解得ODE通解为
$$x=Ce^{3y}-\dfrac{1}{C}$$
*解2：* 原ODE可化为
$$9e^{6y}(y')^2+x(3e^{3y}y')-e^{3y}=0$$
令$u=e^{3y}$，则
$$(u')^2+xu'-u=0$$
令$p=u'$，则
$$u=p^2+xp$$
故
$$\text{d}u=p\text{d}x=(2p+x)\text{d}p+p\text{d}x$$
因此$p=-\dfrac{x}{2}$或$p=C_1$。
由于$p=-\dfrac{x}{2}$时$u=-\dfrac{x^2}{4}$不满足$u>0$，故取$p=C_1$。此时
$$u=C_1^2+C_1x=e^{3y}$$
因此ODE的通解为
$$x=Ce^{3y}-\dfrac{1}{C}$$
### 奇解
**定义（奇解）：** 设函数$y=\phi(x)$在某区间$J$上有定义且是一阶微分方程$$F(x,y,y')=0$$的一个特解，其积分曲线为$$\Gamma=\{(x,y)\mid y=\phi(x),x\in J\}$$若对每一点$M\in\Gamma$，在$M$的任意邻域内ODE：$F(x,y,y')=0$都有一个不同于特解$\phi(x)$的解在点$M$与$\Gamma$相切，则称特解$y=\phi(x)$时方程$F(x,y,y')=0$的一个**奇解**。
**定理（奇解存在的必要条件）：** 设函数$F(x,y,p)$对$(x,y,p)\in G$是连续的，而且对$y$和$p$的偏导数$F_y$和$F_p$在区域$G$中是连续的。若函数$y=\phi(x)(x\in J)$是微分方程$F(x,y,y')=0$的一个奇解，并且$$(x,\phi(x),\phi'(x))\in G(x\in J)$$则奇解$y=\phi(x)$满足如下的联立方程组：
$$\begin{cases}
F(x,y,p)=0,\\
F_p(x,y,p)=0
\end{cases}$$
其中$p=\dfrac{\text{d}\phi(x)}{\text{d}x}$。
这里，称该联立方程组为 $p$**-判别式**。从该方程组中消去$p$得到的曲线方程$$C(x,y)=0$$称为$p$**-判别曲线**。因此，微分方程$F(x,y,y')=0$的奇解是一条$p$-判别曲线。
**定理（奇解的验证方法）：** 设函数$F(x,y,p)$对$(x,y,p)\in G$是二阶连续可微的。又设由微分方程的$p$-判别式
$$\begin{cases}
F(x,y,p)=0,\\
F_p(x,y,p)=0
\end{cases}$$
消去$p$后得到的函数$y=\phi(x)(x\in J)$是微分方程$F(x,y,y')=0$的解，而且条件
$$\begin{cases}
F_y(x,\phi(x),\phi'(x))\neq 0,\\
F_{pp}(x,\phi(x),\phi'(x))\neq 0,\\
F_p(x,\phi(x),\phi'(x))=0
\end{cases}$$
对于$x\in J$成立，则$y=\phi(x)$是微分方程$F(x,y,y')=0$的奇解。
**定义（包络）：** 设单参数$C$的曲线族
$$K(C):V(x,y,C)=0$$
其中函数$V(x,y,C)$对$(x,y,C)\in D$是连续可微的。在平面上有一条连续可微的曲线$\Gamma$，如果对于任一点$Q\in\Gamma$，在曲线族$K(C)$中都有一条曲线$K(C^*)$通过$Q$点并在该点与$\Gamma$相切，而且曲线$K(C^*)$在$Q$点的某邻域内不同于$\Gamma$，则称曲线$\Gamma$为曲线族$K(C)$的一支**包络**。
**定理（包络和奇解的关系）：** 设微分方程
$$F(x,y,y')=0$$
的解为
$$V(x,y,C)=0$$
又设积分曲线族$V(x,y,C)=0$的包络为
$$\Gamma:y=\phi(x)(x\in J)$$
则包络$y=\phi(x)$是微分方程$F(x,y,y')=0$的奇解。
**定理（包络的必要条件）：** 设$\Gamma$是曲线族$K(C):V(x,y,C)=0$的一支包络，并且有如下的参数表达式：
$$x=f(C),\quad y=g(C)(C\in I)$$
其中$f(C)$和$g(C)$对$C$是连续可微的，$C$是曲线族$K(C)$的参数，则它满足如下的$C$**-判别式**：
$$\begin{cases}
V(x,y,C)=0,\\
V_C(x,y,C)=0
\end{cases}$$
消去$C$得
$$\Omega(x,y)=0$$
**定理（包络的验证方法）：** 设由曲线族$K(C):V(x,y,C)=0$的$C$-判别式$$V(x,y,C)=0,\quad V_C(x,y,C)=0$$确定一支连续可微且不含于曲线族$K(C)$的曲线$$\Gamma:x=\phi(C),\quad y=\psi(C)(C\in J)$$且它满足非退化性条件
$$(\phi'(C),\psi'(C))\neq (0,0),\quad (V_x,V_y)(\phi(C),\psi(C),C)\neq (0,0)$$
则$\Gamma$是曲线族$K(C)$的一支包络。
**例：** 求以单位圆上的一个定点$P(1,0)$和一个动点$Q(\cos\theta,\sin\theta)$连线为直径的曲线族的包络。
*解：* 该曲线族为
$$\left(x-\dfrac{1+\cos\theta}{2}\right)^2+\left(y-\dfrac{\sin\theta}{2}\right)^2=(\cos\theta-1)^2+\sin^2\theta$$
记
$$V(x,y,\theta)=\left(x-\dfrac{1+\cos\theta}{2}\right)^2+\left(y-\dfrac{\sin\theta}{2}\right)^2-(\cos\theta-1)^2-\sin^2\theta$$
后面就求出$V_{\theta}(x,y,\theta)$后消去$\theta$再验证是否是包络。
## 微分方程的一般理论
主要研究一阶ODE的初值问题
$$
\begin{cases}
\dfrac{\text{d}y}{\text{d}x}=f(x,y)\\
y(x_0)=y_0
\end{cases}
$$
的解的性质。
### 一阶常微分方程的几何含义
**方向场：** 一阶ODE$y'=f(x,y)$中，$f(x,y)$在区域$G$中有定义，以$(x,y)$为中心作一单位线段，使其斜率为$k=f(x,y)$，称为在点$(x,y)$的**线素**，这样就在区域$G$中确定了一个**方向场**。在方向场中，方向相同的点的几何轨迹称为**等斜线**，即$f(x,y)=k$，$k$为参数。
**积分曲线：** 假设方程$y'=f(x,y)$的解$y=\varphi(x)$在某个区间$J$上有定义，则其图像$y=\varphi(x)\in C^1(J), x\in J$。几何上，这是$(x,y)$平面上的一条$C^1$曲线，称为方程的**积分曲线**或**解曲线**。
**定理：** $L$为ODE：$y'=f(x,y)$的积分曲线的充要条件：在$L$上的任意一点，$L$的切线方向与$y'=f(x,y)$所确定的方向场在该点方向重合（即相切）。
### 一阶常微分方程初值问题解的存在性和唯一性
#### Euler折线——求过一点的近似积分曲线
假设初值问题在矩形区域$G=\{(x,y)\mid |x-x_0|\leq a,\ |y-y_0|\leq b\}$。并且$f(x,y)$在给定区域上连续且有界，上界为$M$。记$\alpha=\min\{a,\dfrac{b}{M}\}$，分点为：
$$
x_k=x_0+kh,\quad k=0,1,\cdots, n,\quad h=\dfrac{\alpha}{n},\quad x_n=x_0+\alpha
$$
用经过$(x_0,y_0)$且斜率为$f(x_0,y_0)$的线段来近似积分曲线，则
$$
y=f(x_0,y_0)(x-x_0)+y_0
$$
故有
$$
y_k=y_{k-1}+f(x_{k-1},y_{k-1})h,\quad k=1,2,\cdots,n
$$
因此Euler折线的计算公式为：
$$
y=\varphi_n(x)=\left\{\begin{array}{lc}
y_0+\sum_{j=0}^{k-1}f(x_j,y_j)h+f(x_k,y_k)h(x-x_k), & x_k\leq x\leq x_{k+1},k\geq 1\\
y_0+f(x_0,y_0)(x-x_0), & x_{-1}\leq x\leq x_1\\
y_0-\sum_{j=1}^{k-1}f(x_j,y_j)h+f(x_k,y_k)h(x-x_k), & x_{k-1}\leq x\leq x_k, k\leq -1
\end{array}\right.
$$
#### Picard迭代序列
初值问题是等价于积分方程：
$$
y(x)=y_0+\int_{x_0}^xf(t,y(t))\text{d}t
$$
构造Picad迭代序列$\{\varphi_n(x)\}$：
$$
\begin{cases}
\varphi_0(x)=y_0\\
\varphi_n(x)=y_0+\int_{x_0}^xf(\xi,\varphi_{n-1}(\xi))\text{d}\xi
\end{cases}\quad ,\quad x_0\leq x\leq x_0+h
$$
#### Peano存在性定理
考虑在区间$I=[a,b]$上连续的函数序列$\{f_n(x)\}_{n=1}^{\infty}$。
**等度连续：** $\forall \varepsilon>0,\ \exists\delta=\delta(\varepsilon)$，当$x_1,x_2\in I$且$|x_1-x_2|<\delta$时，$\forall n\in N$，有
$$
|f_n(x_1)-f_n(x_2)|<\varepsilon
$$
成立，则称连续函数序列$\{f_n(x)\}_{n=1}^{\infty}$在$I$上等度连续。
**一致有界：** 若存在一个与$x$和$n$都无关的常数$K$，使得
$$
|f_n(x)|\leq K,\quad \forall x\in I,\quad \forall n\in N
$$
成立，则称$\{f_n(x)\}_{n-1}^{\infty}$在$I$上一致有界。
**Ascoli-Arzela定理：** 有限闭区间$I$上一致有界、等度连续的函数序列$\{f_n(x)\}_{n-1}^{\infty}$至少存在一个在$I$上一致收敛的子序列$\{f_{n_k}(x)\}_{k=1}^{\infty}$，并且其极限函数$f(x)$在$I$上连续。
*Proof.* 取$A=I\cap\mathbb{Q}$是$I$的一个稠密子集，$A=\{x_1,x_2,\cdots\}$.
*Step 1.* 证明子列在$A$上收敛：
$\forall n\in N$，有$|f_n(x_1)|\leq K$。则存在一个收敛子列$\{f_{n_k}^{(1)}(x_1)\}$；
$\forall n\in N$，有$|f_n(x_2)|\leq K$。则$\{f_{n_k}^{(2)}(x_2)\}$是$\{f_{n_k}^{(1)}(x_2)\}$的一个收敛子列；
……
取$\{g_k(x)\}=\{f_{n_k}^{(k)}(x)\}$，则在$x\in A$上是收敛的。
*Step 2.* $\forall\varepsilon>0,\ \exists\delta=\delta(\varepsilon)>0,\ \forall|x_1-x_2|<\delta$，都有
$$
|g_n(x_1)-g_n(x_2)|<\varepsilon,\quad \forall n\in N
$$
取$I$的一个分解$I=\bigcup_{i=1}^MI_i$，使得$|I_i|\leq\delta$，并且$\exists\widetilde{x_i}\in A\cap I_i$，则$\{g_n(\widetilde{x_i})\}$是一个Cauchy列，则$\exists N_i,\ m,n\geq N_i$时，有
$$
|g_m(\widetilde{x_i})-g_n(\widetilde{x_i})|<\varepsilon
$$
取$N=\max_{1\leq i\leq M}\{N_i\}$，当$m,n\geq N\geq N_i$时，$\forall x\in I,\exists I_i$使得$x\in I_i,\ \widetilde{x_i}\in I_i$，则
$$
|g_m(x)-g_n(x)|\leq |g_m(x)-g_m(\widetilde{x_i})|+|g_m(\widetilde{x_i})-g_n(\widetilde{x_i})|+|g_n(\widetilde{x_i})-g_n(x)|<3\varepsilon
$$
因此对固定$x\in I$，$\{g_n(x)\}$是Cauchy列。并且其极限是连续的。
**Peano存在性定理：** 若$f(x,y)$在矩形区域$G=\{(x,y)\mid |x-x_0|\leq a,\ |y-y_0|\leq b\}$上连续。则ODE的初值问题在区间$[x_0-\alpha,x_0+\alpha]$上至少存在一个解。其中$\alpha=\min\left\{a,\dfrac{b}{M}\right\},M=\max_{(x,y)\in G}|f(x,y)|$。
*Proof.* 分两步证明。(i)证明Euler折线序列是一致有界、等度连续的；(ii)其收敛子列的极限是方程的解。
(i)只需要证明右行解，左行解同理。因此构造Euler折线序列
$$
\varphi_n(x)=\left\{\begin{array}{lc}
y_0+f(x_0,y_0)(x-x_0), & x\in [x_0,x_1]\\
y_0+\sum_{j=0}^{k-1}f(x_j,y_j)h+f(x_k,y_k)h(x-x_k), & x\in [x_k,x_{k+1}]
\end{array}\right.
$$
则有
$$
|\varphi_n(x)-y_0|\leq\sum_{i=0}^{k-1}Mh+M(x-x_k)=M(x-x_0)=M\alpha\leq b
$$
因此是一致有界的。同时，$\forall x_1,x_2\in [x_0,x_0+\alpha]$，有
$$
|\varphi_n(x_1)-\varphi_n(x_2)|\leq M|x_1-x_2|<\varepsilon,\quad |x_1-x_2|<\delta=\dfrac{\varepsilon}{M}
$$
因此$\{\varphi_n(x)\}$是一致有界、等度连续的。
(ii)已知函数满足积分方程
$$
y(x)=y_0+\int_{x_0}^xf(t,y(t))\text{d}t
$$
定义：
$$
\Phi_n(x)=y_0+\sum_{i=0}^{k-1}\int_{x_i}^{x_i+h}f(t,\varphi_n(t))\text{d}t+\int_{x_k}^xf(t,\varphi_n(t))\text{d}t,\quad x\in [x_k,x_{k+1}]
$$
要证明$\{\Phi_n(x)\}$与$\{\varphi_n(x)\}$收敛到同一个函数，即$\lim_{n\to\infty}|\Phi_n(x)-\varphi_n(x)|=0$。
$$
\begin{aligned}
|\Phi_n(x)-\varphi_n(x)|&\leq\sum_{i=0}^{k-1}\int_{x_i}^{x_i+h}|f(t,\varphi_n(t))-f(x_i,\varphi_n(x_i))|\text{d}t\\
&+\int_{x_k}^x|f(t,\varphi_n(t))-f(x_k,\varphi_n(x_k))|\text{d}t
\end{aligned}
$$
由$f$的连续性，$\forall\varepsilon>0,\exists\delta>0,\forall (t,s),(x,y)\in G$，如果$|t-x|+|s-y|<\delta$，则
$$
|f(t,s)-f(x,y)|<\varepsilon
$$
因此当$n\to\infty$时，有
$$
|\Phi_n(x)-\varphi_n(x)|\leq\varepsilon(x-x_0)\leq\varepsilon\alpha
$$
因此$\lim_{n\to\infty}|\Phi_n(x)-\varphi_n(x)|=0$。
取$\{\varphi_n(x)\}$的收敛子列$\{\varphi_{n_k}(x)\}$，记其极限为$\varphi(x)$，则有$\lim_{k\to\infty}\Phi_{n_k}(x)=\varphi(x)$。带入$\Phi_n(x)$的定义式可以得到$\varphi(x)$是积分方程的解。
#### Picard存在唯一性定理
**Lipschitz条件：** 对于区域$G$中的某个有界闭集$K\subset G$，存在一个常数$L_K>0$，使得$\forall (x_1,y_1),(x_2,y_2)\in K$，有
$$
|f(x_1,y_1)-f(x_2,y_2)|\leq L_K|y_1-y_2|
$$
都成立，则称$f(x,y)$在$G$中关于$y$满足（局部）Lipschitz条件。$L_K$称为Lipschitz常数。简写为
$$
f\in\operatorname{Lip}_y(G)
$$
**Picard存在唯一性定理：** 设$f(x,y)$在矩形区域$G=\{(x,y)\mid |x-x_0|\leq a,\ |y-y_0|\leq b\}$内连续，且$f\in\operatorname{Lip}_y(G)$，则ODE的初值问题在区间$[x_0-\alpha,x_0+\alpha]$上有且仅有一个解。其中$\alpha=\min\left\{a,\dfrac{b}{M}\right\},M=\max_{(x,y)\in G}|f(x,y)|$。

*Proof.* 构造Picard迭代序列：
$$
\begin{cases}
\phi_0(x)=y_0\\
\phi_n(x)=y_0+\int_{x_0}^xf(t,\phi_{n-1}(t))\text{d}t,\quad n=0,1,2,\cdots
\end{cases}
$$
(i)首先证明$(x,\phi_n(x))$不会超出区域$G$：
$$
|\phi_n(x)-y_0|\leq\int_{x_0}^x|f(t,\phi_n(t))|\text{d}t\leq M(x-x_0)\leq M\alpha\leq b
$$
(ii)作如下定义：
$$
\phi_n(x)=\phi_0(x)+\sum_{k=1}^n(\phi_k(x)-\phi_{k-1}(x))\triangleq\phi_0(x)+\sum_{k=1}^n\Delta_k(x)
$$
因此有
$$
\Delta_{k+1}(x)=\phi_{k+1}(x)-\phi_k(x)=\int_{x_0}^x[f(t,\phi_k(t))-f(t,\phi_{k-1}(t))]\text{d}t
$$
所以可以得到
$$
|\Delta_1(x)|=\left|\int_{x_0}^xf(t,y_0)\text{d}t\right|\leq M|x-x_0|
$$
并且
$$
|\Delta_{k+1}(x)|\leq\int_{x_0}^xL|\Delta_k(t)|\text{d}t
$$
因此由数学归纳法可以得到
$$
|\Delta_k(x)|\leq\dfrac{L^{k-1}M(x-x_0)^k}{k!}=\dfrac{M}{L}\dfrac{[L(x-x_0)]^k}{k!}
$$
故
$$
\lim_{n\to\infty}\sum_{k=1}^n|\Delta_k(x)|\leq\dfrac{M}{L}\sum_{k=1}^{\infty}\dfrac{[L(x-x_0)^k]}{k!}=\dfrac{M}{L}[e^{L|x-x_0|}-1]
$$
因此$\{\phi_n(x)\}$是收敛的，在其定义式两边同时取极限可以得到积分方程。存在性得证。
(iii)假设存在$\varphi(x),\psi(x)$都是初值问题的解。则
$$
|\delta(x)|=|\varphi(x)-\psi(x)|=\left|\int_{x_0}^x[f(t,\varphi(t))-f(t,\psi(t))]\text{d}t\right|\leq\int_{x_0}^xL|\delta(t)|\text{d}t
$$
注意到
$$
|\delta(x)|=|\varphi(x)-\psi(x)|\leq|\varphi(x)-y_0|+|\psi(x)-y_0|\leq 2M|x-x_0|
$$
因此由数学归纳法可以得到
$$
|\delta(x)|\leq2ML\lim_{n\to\infty}\dfrac{[L|x-x_0|]^n}{n!}=0
$$
因此$\delta(x)\equiv 0$。唯一性得证。

> 也可以用压缩映射定理证明：
> 压缩映射的定义：设$T$是一个从函数到函数的映射，如果$$\sup_{x\in I}|Tf(x)-Tg(x)|\leq\lambda\sup_{x\in I}|f(x)-g(x)|,\quad\lambda<1$$则称映射$T$是一个**压缩映射**。
> **压缩映射定理**：如果$T$是一个压缩映射，则$\exists ! f$使得$T(f)=f$。
> **用压缩映射定理证明Picard存在唯一性定理** 
> 设映射$T$为$$Tf(x)=y_0+\int_{x_0}^xK(s,f(s))\text{d}s$$其中$K(x,y)$满足 $$\dfrac{\text{d}y}{\text{d}x}=K(x,y)$$则$$
\begin{aligned}
\sup_{x\in I}|Tf(x)-Tg(x)|&\leq\sup_{x\in I}|\int_{x_0}^x[K(s,f(s))-K(s,g(s))]\text{d}s|\\
&\leq \sup_{x\in I}\int_{x_0}^xL|f(s)-g(s)|\text{d}s\\
&\leq L\sup_{x\in I}|x-x_0|\sup_{x\in I}|f(x)-g(x)|
\end{aligned}$$
> 因此$T$是一个压缩映射，故只存在唯一的$f(x)$满足$$Tf(x)=f(x)$$即ODE初值问题的积分方程。

**Gronwall不等式：** 设$\alpha(x)$和$u(x)$是区间$[x_0,x_1]$上的实值非负连续函数。若对于$x\in [x_0,x_1]$，有：
$$
u(x)\leq C+\int_{x_0}^x[\alpha(s)u(s)+K]\text{d}s
$$
其中的$C$和$K$是非负常数，则当$x\in [x_0,x_1]$时，有
$$
u(x)\leq [C+K(x-x_0)]e^{\int_{x_0}^x\alpha(s)\text{d}s}
$$
*Proof.* 令$w(x)=C+\int_{x_0}^x[\alpha(s)u(s)+K]\text{d}s$，则有：
$$
w'(x)=\alpha(x)u(x)+K\leq\alpha(x)w(x)+K
$$
因此
$$
[w(x)e^{-\int_{x_0}^x\alpha(s)\text{d}s}]'\leq Ke^{-\int_{x_0}^x\alpha(s)\text{d}s}
$$
两边积分得
$$
w(x)e^{-\int_{x_0}^x\alpha(s)\text{d}s}-w(x_0)\leq\int_{x_0}^xKe^{-\int_{x_0}^s\alpha(t)\text{d}t}\text{d}s
$$
由于$w(x_0)=C$，故有
$$
w(x)e^{-\int_{x_0}^x\alpha(s)\text{d}s}\leq C+\int_{x_0}^xK\text{d}s=C+K(x-x_0)
$$
故
$$
u(x)\leq w(x)\leq[C+K(x-x_0)]e^{\int_{x_0}^x\alpha(s)\text{d}s}
$$
### 解的延拓与整体解
#### 解的延拓
**拼接引理：** 若$\varphi(x),\psi(x)$是ODE的解。$\varphi(x)$在$x\in [a,b]$成立，$\psi(x)$在$x\in [b,c]$成立，且$\varphi(b)=\psi(b)$，则函数
$$
y(x)=\begin{cases}
\varphi(x),\quad x\in [a,b]\\
\psi(x),\quad x\in [b,c]
\end{cases}
$$
是方程在$[a,c]$上的一个解。
**延拓引理：** 若函数$f(x,y)\in C(G)$，$\varphi(x)$是方程$y'=f(x,y)$在区间$[x_0,b)$上的一个解，且集合$\{(x,\varphi(x))\mid x\in[x_0,b)\}\subset A\subset G$，其中$A$是有界闭集，则$y=\varphi(x)$可以延拓到闭区间$[x_0,b]$。
**延拓定理：** 设$f(x,y)\in C(G)$，$(x_0,y_0)\in G$，设$\Gamma$是ODE：$y'=f(x,y)$经过$(x_0,y_0)$的一条积分曲线，则积分曲线在$G$内延伸到$\partial G$。
> 设$y=\varphi(x)$的最大右行存在区间是$[x_0,b)$，这里包含以下三种情况：
> *  $b=+\infty$，右行整体解存在；
> * $b<+\infty$，且$\lim_{x\to b^-}|\varphi(x)|=+\infty$，即存在爆破解；
> * $b<+\infty$，且$\lim_{x\to b^-}\operatorname{dist}(\partial G,(x,\varphi(x)))=0$。即在$b^-$附近积分曲线与$\partial G$渐进。
#### 解的整体存在性
**定义（饱和解）：** 设函数$\phi(x)$是ODE定义在区间$I$上的一个解，$\psi(x)$是它定义在$(a_1,b_1)$上的另一个解，其中$I\subset (a_1,b_1)$。如果对于$x\in I$满足$\psi(x)\equiv \phi(x)$，则称解$\phi(x)$是**可延拓**的，并称$\psi(x)$是$\phi(x)$在区间$(a_1,b_1)$上的一个**延拓**。相反，如果不存在满足上述条件的解$\psi(x)$，则称解$\phi(x)$是ODE的一个**饱和解**。
**定理：** 假设函数$f(x,y)$在连通区域$G\subset \mathbb{R}^2$内连续且关于$y$满足Lipschitz条件，则ODE过$G$内每一点存在唯一的饱和解。
**定理：** 设$f(x,y)$是$R=\{(x,y)\mid a<x<b,|y|<+\infty\}$上的连续函数，且在$R$上关于$y$满足一致Lipschitz条件，即存在常数$L$，使得对任意$(x,y_1)\in R$和$(x,y_2)\in R$满足
$$|f(x,y_1)-f(x,y_2)|\leq L|y_1-y_2|$$
则$y'=f(x,y)$的每一个饱和解的存在区间都是$(a,b)$。
### 比较定理与解的存在性估计
**定理** 设函数$f(x,y)$是区域$G=\{(x,y): a<x<b,-\infty<y<+\infty\}$内的连续函数。$(x_0,y_0)\in G$。设ODE初值问题解的右行最大存在区间为$[x_0,\beta_1)$。则有：
> (1) 初值问题有右行上解$\Phi(x)$和右行下解$\varphi(x)$，且它们都在区间$[x_0,\beta)$上有定义，则$\beta_1>\beta$。
> (2) 若初值问题有右行上解$\Phi(x)$，它的最大右行区间为$[x_0,\beta)$。且当$x\to\beta^-$时，$\Phi(x)\to-\infty$，则$\beta_1\leq \beta$。
> (3) 若初值问题有右行下解$\varphi(x)$，它的最大右行区间为$[x_0,\beta)$。且当$x\to\beta^-$时，$\varphi(x)\to+\infty$，则$\beta_1\leq \beta$。

*Proof.*   (1) 取$G=\{(x,y): x_0-\varepsilon<\beta-\varepsilon,\varphi(x)-2<y<\Phi(x)+2\}$，根据延拓定理，$y(x)$可延拓到$\partial G$。由于$\varphi(x)$达不到上下边界，因此只能达到右边界，即$\beta_1>\beta-\varepsilon$，根据$\varepsilon$的任意性，可以得到$\beta_1>\beta$。
(2) 反证法。假设$\beta_1>\beta$，$y(x)$在$[x_0,\beta]$上有定义，故有界。因此
$$
y(\beta)=\lim_{x\to\beta^-}y(x)\leq\lim_{x\to\beta^-}\Phi(x)=-\infty
$$
矛盾。
(3) 与(2)同理。
**定理** 若$G=(a,b)\times(-\infty,+\infty)$，函数$f(x,y)\in C(G)$，假设$\exists$常数$M,N>0$使得
$$
f(x,y)\leq M|y|+N,\quad\forall(x,y)\in G
$$
*Proof*. 用上面的定理是显然的。这种方程也称为**拟线性方程**。
**例:**  考虑初值问题
$$
\begin{cases}y'=x^3-y^3\\
y(0)=c
\end{cases}
$$
(1) $\forall c\in\mathbb{R}$，证明右行解总存在于$[0,+\infty)$;
(2) $\forall c>0$，证明左行解的存在区间有限。
*Proof.* (1) 记$f(x,y)=x^3-y^3$，由于
$$
f(x,y)=(x-y)(x^2+xy+y^2)
$$
取
$$
\Phi(x)=x+|c|,\quad \varphi(x)=-x-|c|
$$
则在区间$[0,+\infty)$上有
$$
\dfrac{\text{d}\Phi(x)}{\text{d}x}=1>f(x,\Phi(x)),\quad \Phi(0)\geq |c|
$$
以及
$$
\dfrac{\text{d}\varphi(x)}{\text{d}x}=-1<f(x,\varphi(x)),\quad \varphi(0)\leq |c|
$$
因此二者分别是初值问题的右行上解和右行下解，它们存在公共区间$[0,+\infty)$，因此初值问题的解在$[0,+\infty)$上存在。
(2) 做时间反演变换，令$t=-x$，则有
$$\begin{cases}
y'=t^3+y^3\\
y(0)=c
\end{cases}$$
只需证明该ODE初值问题的右行解存在区间有限。记$g(t,y)=t^3+y^3$，构造函数
$$\phi(t)=\dfrac{c}{\sqrt{1-2c^2t}}$$
它是ODE初值问题$y'=y^3,y(0)=c$的解，因此$\phi(t)$是原ODE的一个右行下解。
而$\phi(t)$的右行存在区间为$[0,\dfrac{1}{2c^2}]$是有限的，因此该ODE初值问题的右行解存在区间有限。
### 解的连续依赖性
考虑初值问题的解$y(x;x_0,y_0)$：
* 当$x_0,y_0$变化很小时，$y(x;x_0,y_0)$是否变化很小;
* 当$f$变化很小时，$y(x;x_0,y_0)$是否变化很小。
**定理：** $F,f\in C(G)$，且在$G$中满足$\forall\varepsilon>0$，
$$
|F(x,y)-f(x,y)|<\varepsilon
$$
$f$关于$y$满足Lipschitz条件，对于$(x_0,y_0)\in G$，函数$y(x)$和$\varphi(x)$分别是ODE
$$
\begin{cases}
y'=f(x,y)\\
y(x_0)=y_0
\end{cases}
$$
和
$$
\begin{cases}
\varphi'=f(x,\varphi)\\
\varphi(x_0)=y_0
\end{cases}
$$
的解，则在它们的公共存在区间$[x_0-\alpha,x_0+\alpha]$上，有
$$
|y(x)-\varphi(x)|\leq\dfrac{\varepsilon}{L}(e^{L\alpha}-1)
$$
*Proof.* $\forall x\in[x_0,x_0+\alpha]$，有
$$
y(x)=y_0+\int_{x_0}^xf(t,y(t))\text{d}t\\
\varphi(x)=y_0+\int_{x_0}^xF(t,\varphi(t))\text{d}t
$$
则
$$
\begin{aligned}y(x)-\varphi(x)&=\int_{x_0}^x\left[f(t,y(t))-F(t,\varphi(t))\right)]\text{d}t\\
&=\int_{x_0}^x[f(t,y(t))-f(t,\varphi(t))]\text{d}t\\& +\int_{x_0}^x[f(t,\varphi(t))-F(t,\varphi(t))]\text{d}t
\end{aligned}
$$
因此可以得到
$$
\begin{aligned}
|y(x)-\varphi(x)|&\leq\int_{x_0}^xL|y(t)-\varphi(t)|\text{d}t+\int_{x_0}^x\varepsilon\text{d}t\\
&=L\int_{x_0}^x\left(\dfrac{\varepsilon}{L}+|y(t)-\varphi(t)|\right)\text{d}t
\end{aligned}
$$
等式两边加$\dfrac{\varepsilon}{L}$并应用Gronwall不等式可以得到
$$
\dfrac{\varepsilon}{L}+|y(x)-\varphi(x)|\leq\dfrac{\varepsilon}{L}e^{L(x-x_0)}\leq\dfrac{\varepsilon}{L}e^{L\alpha}
$$
**定理（解对初值连续依赖性）：** $f\in C(G)\cap \operatorname{Lip}_y$ ，$(x_0,y_0)\in G$。若$y=\varphi(x;x_0,y_0), x\in J$是ODE初值问题过$(x_0,y_0)$的唯一饱和解，对于闭子区间$[a,b]\subset J$。则当$(\xi,\eta)$充分接近$(x_0,y_0)$时，方程以$y(\xi)=\eta$为初值条件的唯一饱和解$y=\varphi(x;\xi,\eta)$在$[a,b]$上有定义，并且
$$
\lim_{(\xi,\eta)\to(x_0,y_0)}\max_{x\in[a,b]}|\varphi(x;\xi,\eta)-\varphi(x;x_0,y_0)|=0
$$
*Proof.* 令$S=\{(x,\varphi(x;x_0,y_0))\mid a\leq x\leq b\}$。$\forall x\in S$，记
$$
O_{x_i}=\{(x,y)\mid|x-x_i|<2\varepsilon(x_i),|y-\varphi(x;x_0,y_0)|<2\varepsilon(x_i)\},\quad i\in I
$$
且$f$在$O_{x_i}$上的Lipschitz常数为$L_i$，则$S\subset\bigcup_{i\in I}O_{x_i}$存在有限个子覆盖，记为
$$
S\subset\bigcup_{j=1}^NO_{x_j}
$$
特别地，我们有
$$
[a,b]\subset\bigcup_{j=1}^N\{x\mid|x-x_j|<2\varepsilon_j(x_j)\}
$$
取$\varepsilon_0=\min_{1\leq j\leq N}\{\varepsilon_j(x_j)\},L_0=\max_{1\leq j\leq N}\{L_j\}$，令
$$
O_S=\{(x,y)\mid a\leq x\leq b,\quad |y-\varphi(x;x_0,y_0)|<\varepsilon_0\}
$$
则有
$$
S\subset O_S\subset \bigcup_{j=1}^NO_{x_j}
$$
且$f$在$O_S$上一致Lipschitz连续，Lipschitz常数为$L_0$，那么
$$
\begin{aligned}
&|\varphi(x;x_0,y_0)-\varphi(x;\xi,\eta)|\\\leq&|y_0-\eta|+\left|\int_{x_0}^xf(t,\varphi(t;x_0,y_0)\text{d}t-\int_\xi^xf(t,\varphi(t;\xi,\eta)\text{d}t\right|\\
\leq &|y_0-\eta|+M|x_0-\xi|+\int_{x_0}^xL_0|\varphi(t;x_0,y_0)-\varphi(t;\xi,\eta)|\text{d}t\\
\leq &(M|x_0-\xi|+|y_0-\eta|)e^{L_0|x-x_0|}
\end{aligned}
$$
取$\delta=\dfrac{\varepsilon_0}{M+1}e^{-L(b-a)}$，则当$|\xi-x_0|,|y-y_0|<\delta$时，有
$$
|\varphi(x;x_0,y_0)-\varphi(x;\xi,\eta)|<\varepsilon_0
$$
证毕。
**定理（解对初值的可微性）：** $f,f_y\in C(G)$，则对于$(x_0,y_0)\in G$，方程满足初值条件$y(x_0)=y_0$的解$y=\varphi(x;x_0,y_0)$作为$(x,x_0,y_0)$的函数，在它的存在区间内是连续可微的。

**Q:** 如何计算$w(x)=\dfrac{\partial\varphi(x;x_0,y_0)}{\partial x_0}, z(x)=\dfrac{\partial\varphi(x;x_0,y_0)}{\partial y_0}$？

已知
$$
\varphi(x;x_0,y_0)=y_0+\int_{x_0}^xf(t,\varphi(t;x_0,y_0))\text{d}t
$$
两边对$y_0$求偏导：
$$
\dfrac{\partial\varphi(x;x_0,y_0)}{\partial y_0}=1+\int_{x_0}^xf_y(t,\varphi(t;x_0,y_0))\dfrac{\partial\varphi(t;x_0,y_0)}{\partial y_0}\text{d}t
$$
相当于ODE初值问题：
$$
\begin{cases}
z'(x)=f_y(x,\varphi(x;x_0,y_0))z(x)\\
z(x_0)=1
\end{cases}
$$
两边对$x_0$求偏导：
$$
\dfrac{\partial\varphi(x;x_0,y_0)}{\partial x_0}=0+\int_{x_0}^xf_y(t,\varphi(t;x_0,y_0))\dfrac{\partial\varphi(t;x_0,y_0)}{\partial x_0}\text{d}t-f(x_0,y_0)
$$
相当于ODE初值问题：
$$
\begin{cases}
w'(x)=f_y(x,\varphi(x;x_0,y_0))w(x)\\
w(x_0)=-f(x_0,y_0)
\end{cases}
$$
**Q:** 如何计算$v(x)=\dfrac{\partial\varphi(x,x_0,y_0,\lambda)}{\partial \lambda}$?

不求了，是个非齐次方程：
$$
\begin{cases}
v'(x)=f_y(x,\varphi(x,x_0,y_0,\lambda),\lambda)v(x)+f_\lambda(x,\varphi(x,x_0,y_0,\lambda),\lambda)\\
v(x_0)=0
\end{cases}
$$
### 二阶微分方程的求解
考虑$y''=f(x,y,y')$。
(i) $y''=f(x)$：直接积分两次。
(ii) $y''=f(x,y')$：令$z=y'$，则变成$z'=f(x,z)$。
(iii) $y''=f(y,y')$：令$z=y'$，则化为$z\dfrac{\text{d}z}{\text{d}y}=f(y,z)$。
## 线性微分方程（组）
### 线性微分方程组解的结构
#### 线性微分方程组
记$\mathbf{x}(t)=[x_1(t),x_2(t),\cdots,x_n(t)]^{\mathrm{T}}$是定义在区间$I$上的$n$维未知向量函数，记
$$
\dfrac{\text{d}\mathbf{x}(t)}{\text{d}t}=[\dfrac{\text{d}x_1(t)}{\text{d}t},\dfrac{\text{d}x_2(t)}{\text{d}t},\cdots,\dfrac{\text{d}x_n(t)}{\text{d}t}]^{\mathrm{T}}
$$
记
$$
\mathbf{A}(t)=(a_{ij}(t))_{n\times n},\quad \mathbf{b}(t)=[f_1(t),f_2(t),\cdots,f_n(t)]^{\mathrm{T}}
$$
分别是定义在区间$I$上的$n\times n$矩阵函数和$n$维向量函数。它们的分量关于$t$是区间$I$上的连续函数。则线性微分方程组可以表示为
$$
\dfrac{\text{d}\mathbf{x}(t)}{\text{d}t}=\mathbf{A}(t)\mathbf{x}(t)+\mathbf{b}(t)
$$
对于一般的ODE，有
$$
\dfrac{\text{d}\mathbf{x}(t)}{\text{d}t}=\mathbf{f}(t,\mathbf{x}(t))
$$
则可以同样地定义Lipschitz条件，Peano定理、Picard定理和延拓定理、对初值连续依赖性、可微性同样成立。
#### 高阶微分方程
考虑$n$阶微分方程
$$
\dfrac{\text{d}^nx}{\text{d}t}=f(t,x,x',\cdots,x^{(n-1)})
$$
通过变换$x_1=x,x_2=x',\cdots,x_n=x^{(n-1)}$，则可化为
$$
\begin{cases}
\dfrac{\text{d}x_1}{\text{d}t}=x_2,\\
\dfrac{\text{d}x_2}{\text{d}t}=x_3,\\
\cdots\\
\dfrac{\text{d}x_{n-1}}{\text{d}t}=x_n,\\
\dfrac{\text{d}x_n}{\text{d}t}=f(t,x_1,x_2,\cdots,x_n)
\end{cases}
$$
#### 齐次线性微分方程组
考虑线性微分方程组初值问题
$$
\dfrac{\text{d}\mathbf{x}(t)}{\text{d}t}=\mathbf{A}(t)\mathbf{x}(t)+\mathbf{b}(t),\quad \mathbf{x}(t_0)=\mathbf{x}_0
$$
根据存在唯一性定理，这个方程在区间$I=[a,b]$上有唯一解。
**定义：** 如果存在一组不全为0的常数$c_1,c_2,\cdots,c_n$，使得在$I$上
$$
c_1\mathbf{x}_1(t)+c_2\mathbf{x}_2(t)+\cdots+c_n\mathbf{x}_n(t)=\mathbf{0}
$$
则称向量函数$\mathbf{x}_1(t),\mathbf{x}_2(t),\cdots,\mathbf{x}_n(t)$在区间$I$上是**线性相关**的；否则称是**线性无关**的。设$\mathbf{x}_1(t),\mathbf{x}_2(t),\cdots,\mathbf{x}_n(t)$是$n$个给定的$n$维向量函数，则称行列式
$$
W(t)=\operatorname{det}([\mathbf{x}_1(t),\mathbf{x}_2(t),\cdots,\mathbf{x}_n(t)])
$$
是向量函数$\mathbf{x}_1(t),\mathbf{x}_2(t),\cdots,\mathbf{x}_n(t)$的Wronsky行列式。
**引理：** 如果$\mathbf{x}_1(t),\mathbf{x}_2(t),\cdots,\mathbf{x}_n(t)$的Wronsky行列式$W(t)=0$，则$\mathbf{x}_1(t),\mathbf{x}_2(t),\cdots,\mathbf{x}_n(t)$线性相关。如果齐次LODEs的解$\mathbf{x}_1(t),\mathbf{x}_2(t),\cdots,\mathbf{x}_n(t)$线性无关，则$W(t)\neq 0,\ a\leq x\leq b$。
**引理：** 设$\mathbf{x}_1(t),\mathbf{x}_2(t),\cdots,\mathbf{x}_n(t)$是$n$阶齐次线性微分方程组的$n$个解，则它们的Wronsky行列式满足Liouville公式
$$
W(t)=W(t_0)e^{\int_{t_0}^t\operatorname{tr}\mathbf{A}(s)\text{d}s}
$$
*Proof.* 写成分量的形式，对于第$j$个解的第$i$个分量，有
$$
\dfrac{\text{d}x_{ij}(t)}{\text{d}t}=\sum_{k=1}^na_{ik}(t)x_{kj}(t),\quad 1\leq i,j\leq n
$$
固定$i$，则有
$$
\dfrac{\text{d}\mathbf{r}_i}{\text{d}t}=\sum_{k=1}^na_{ik}\mathbf{r}_k
$$
其中$\mathbf{r}_i$表示矩阵$\mathbf{X}=[\mathbf{x}_1(t),\mathbf{x}_2(t),\cdots,\mathbf{x}_n(t)]$的第$i$行。
对$W(t)$求导
$$
\begin{aligned}
W'(t)&=\begin{vmatrix}
x_{11}(t) & x_{12}(t) & \cdots & x_{1n}(t)\\
x_{21}(t) & x_{22}(t) & \cdots & x_{2n}(t)\\
\vdots & \vdots & \ddots & \vdots\\
x_{n1}(t) & x_{n2}(t) & \cdots & x_{nn}(t)
\end{vmatrix}\\&=\sum_{i=1}^n\begin{vmatrix}
\mathbf{r}_1\\
\vdots\\
a_{i1}\mathbf{r}_1+a_{i2}\mathbf{r}_2+\cdots + a_{in}\mathbf{r}_n\\
\vdots\\
\mathbf{r}_n
\end{vmatrix}\\
&=\sum_{i=1}^na_{ii}W(t)=\operatorname{tr}(\mathbf{A}(t))W(t)
\end{aligned}
$$
解此方程，证毕。
**定理：** $n$维线性齐次微分方程组的所有解构成一个$n$维线性空间。
**定义：** $n$阶线性齐次方程组的任意$n$个线性无关解
$$
\mathbf{x}_1(t),\mathbf{x}_2(t),\cdots,\mathbf{x}_n(t)
$$
称为这个方程组的**基本解组**，矩阵
$$
\mathbf{\Phi}(t)=[\mathbf{x}_1(t),\mathbf{x}_2(t),\cdots,\mathbf{x}_n(t)]
$$
称为方程组的**基解矩阵**。称满足$\mathbf{\Phi}(t_0)=\mathbf{I}$的基解矩阵为**预解式**。
在此基础上，$n$阶线性齐次微分方程组的通解可表示为
$$\mathbf{x}(t)=\mathbf{\Phi}(t)\mathbf{c}$$
因此当初值问题的解为
$$\mathbf{x}(t)=\mathbf{\Phi}(t)\mathbf{\Phi}^{-1}(t_0)\mathbf{x}_0$$
#### 非齐次线性微分方程组
考虑$n$阶非齐次线性微分方程组
$$\dfrac{\text{d}\mathbf{x}(t)}{\text{d}t}=\mathbf{A}(t)\mathbf{x}+\mathbf{b}(t)$$
它的通解可由齐次通解和非齐次特解的和表示。用常数变易法，可以得到
$$\mathbf{x}(t)=\mathbf{\Phi}(t)\mathbf{c}+\mathbf{\Phi}(t)\int_{t_0}^t\mathbf{\Phi}^{-1}(s)\mathbf{b}(s)\text{d}s$$
对于满足初值条件$\mathbf{x}(t_0)=\mathbf{x}_0$的解，可以写成
$$\mathbf{x}(t)=\mathbf{\Phi}(t)\mathbf{\Phi}^{-1}(t_0)\mathbf{x}_0+\mathbf{\Phi}(t)\int_{t_0}^t\mathbf{\Phi}^{-1}(s)\mathbf{b}(s)\text{d}s$$
### 高阶线性微分方程解的结构
标准形式的$n$阶线性微分方程为
$$\dfrac{\text{d}^nx}{\text{d}t^n}+p_1(t)\dfrac{\text{d}^{n-1}x}{\text{d}t^{n-1}}+\cdots+p_{n-1}(t)\dfrac{\text{d}x}{\text{d}t}+p_n(t)x=q(t)$$
其中$p_i(t)(i=1,2,\cdots,n),q(t)$是区间$I=(a,b)$上的连续函数。
用前述的方法，可以将其写成一个$n$阶线性微分方程组
$$\dfrac{\text{d}\mathbf{x}(t)}{\text{d}t}=\mathbf{A}(t)\mathbf{x}+\mathbf{b}(t)$$
其中$\mathbf{x}(t)=[x(t),x'(t),\cdots,x^{(n-1)}(t)]^{\mathrm{T}}$，$\mathbf{b}(t)=[0,0,\cdots,q(t)]^{\mathrm{T}}$，且
$$\mathbf{A}(t)=\begin{bmatrix}
0 & 1 & 0 & \cdots & 0 & 0 \\
0 & 0 & 1 & \cdots & 0 & 0 \\
\vdots & \vdots & \vdots & \ddots & \vdots & \vdots \\
0 & 0 & 0 & \cdots & 0 & 1 \\
-p_n(t) & -p_{n-1}(t) & -p_{n-2}(t) & \cdots & -p_2(t) & -p_1(t)
\end{bmatrix}$$
前述的所有定理均可推广。
### 线性微分方程组的求解
#### 线性齐次微分方程组
**定理：** 若$n\times n$矩阵函数$\mathbf{A}(t)$满足可交换条件
$$\mathbf{A}(t)\cdot\int_{t_0}^t\mathbf{A}(s)\text{d}s=\int_{t_0}^t\mathbf{A}(s)\text{d}s\cdot\mathbf{A}(t)$$
则线性齐次微分方程组初值问题
$$\dfrac{\text{d}\mathbf{x}(t)}{\text{d}t}=\mathbf{A}(t)\mathbf{x}(t),\quad \mathbf{x}(t_0)=\mathbf{x}_0$$
的解可表示为
$$\mathbf{x}(t)=e^{\int_{t_0}^t\mathbf{A}(s)\text{d}s}\mathbf{x}_0$$
**定义（指数函数）：** 一般地，若$\mathbf{A}$是一个$n\times n$矩阵，矩阵$\mathbf{A}$的**指数函数**$e^{\mathbf{A}}$定义为
$$e^{\mathbf{A}}=\sum_{k=0}^{\infty}
\dfrac{1}{k!}\mathbf{A}^k$$
其中，定义$\mathbf{A}^0\triangleq \mathbf{I}$。
容易验证矩阵的指数函数满足下列性质：
* 若$\mathbf{A}=\mathbf{0}$是零矩阵，则$e^{\mathbf{A}}=\mathbf{I}$；
* 若$\mathbf{P}$是一个$n\times n$可逆矩阵，则$e^{\mathbf{P}^{-1}\mathbf{A}\mathbf{P}}=\mathbf{P}^{-1}e^{\mathbf{A}}\mathbf{P}$;
* 若$\mathbf{A},\mathbf{B}$是两个$n\times n$可交换矩阵，即$\mathbf{AB}=\mathbf{BA}$，则$$e^{\mathbf{A}}\cdot e^{\mathbf{B}}=e^{\mathbf{B}}\cdot e^{\mathbf{A}}=e^{\mathbf{A}+\mathbf{B}}$$
* 若矩阵$$\mathbf{A}=\operatorname{diag}(\lambda_1,\lambda_2,\cdots,\lambda_n)$$是一个$n$阶对角矩阵，则$$e^{\mathbf{A}}=\operatorname{diag}(e^{\lambda_1t},e^{\lambda_2t},\cdots,e^{\lambda_nt})$$
* 如果矩阵$$\mathbf{J}_k=\begin{bmatrix}\lambda_k & 1 & 0 & \cdots & 0 & 0\\ 0 & \lambda_k & 1 & \cdots & 0 & 0\\ \vdots & \vdots & \vdots & \ddots & \vdots & \vdots\\ 0 & 0 & 0 & \cdots & \lambda_k & 1\\ 0 & 0 & 0 & \cdots & 0 & \lambda_k\end{bmatrix}$$为$k$阶Jordan矩阵，则$$e^{\mathbf{J}_kt}=e^{\lambda_kt}\begin{bmatrix}1 & t & \dfrac{t^2}{2!} & \cdots & \dfrac{t^{k-1}}{(k-1)!} \\ 0 & 1 & t & \cdots & \dfrac{t^{k-2}}{(k-2)!}\\ \vdots & \vdots & \vdots & \ddots & \vdots\\ 0 & 0 & 0 & \cdots & 1\end{bmatrix}$$
* 如果矩阵$$\mathbf{A}=\operatorname{diag}(\mathbf{J}_1,\mathbf{J}_2,\cdots,\mathbf{J}_k)$$是一个$n$阶准对角矩阵，$\mathbf{J}_i(i=1,2,\cdots,k)$为Jordan矩阵块，则$$e^{\mathbf{A}t}=\operatorname{diag}(e^{\mathbf{J}_1t},e^{\mathbf{J}_2t},\cdots,e^{\mathbf{J}_kt})$$
#### 常系数线性微分方程组
注意到，当$\mathbf{A}$是一个常数矩阵时
$$\mathbf{D}(t)=\int_{t_0}^t\mathbf{A}\text{d}s=\mathbf{A}(t-t_0)$$
与$\mathbf{A}$是可交换的。且基解矩阵
$$\mathbf{\Phi}(t)=e^{\mathbf{D}(t)}=e^{\mathbf{A}(t-t_0)}$$
因此只需要对$\mathbf{A}$的特征值和特征向量进行讨论。
**定理：** 如果$n$阶常系数线性齐次微分方程组$\dfrac{\text{d}\mathbf{x}(t)}{\text{d}t}=\mathbf{A}\mathbf{x}(t)$的系数矩阵$\mathbf{A}$有$n$个互异的特征值$\lambda_1,\cdots,\lambda_n$（或有$n$个线性无关的特征向量），则向量函数
$$\boldsymbol{\xi}_1e^{\lambda_1t},\boldsymbol{\xi}_2e^{\lambda_2t},\cdots,\boldsymbol{\xi}_ne^{\lambda_nt}$$
是方程组的一个基本解组，其中$\boldsymbol{\xi}_i$是矩阵$\mathbf{A}$的对应于特征值$\lambda_i$的特征向量。
**定理：** 假设$\lambda_1,\lambda_2,\cdots,\lambda_k$分别是常数矩阵$\mathbf{A}$的$n_1,n_2,\cdots,n_k$重的互异特征值($\sum_{i=1}^kn_k=n$)，$V_j(j=1,2,\cdots,k)$是由代数方程组
$$(\mathbf{A}-\lambda_j\mathbf{I})^{n_j}\mathbf{u}=\mathbf{0},\quad j=1,2,\cdots,k$$
的所有解组成的子空间。在不变子空间$V_j$中取定$n_j$个线性无关的特征向量$\mathbf{v}_j^l\in V_j(l=1,2,\cdots,n_j)$，记
$$\mathbf{x}_j^l(t)=e^{\lambda_j t}\sum_{k=0}^{n_j-1}\dfrac{t^k}{k!}(\mathbf{A}-\lambda_j\mathbf{I})^k\mathbf{v}_j^l$$
则
$$\mathbf{x}_1^1(t),\cdots,\mathbf{x}_1^{n_1}(t);\cdots;\mathbf{x}_k^1(t),\cdots,\mathbf{x}_k^{n_k}(t)$$
是常系数线性齐次微分方程组
$$\dfrac{\text{d}\mathbf{x}(t)}{\text{d}t}=\mathbf{A}\mathbf{x}(t)$$
的一组基础解系。
### 常系数线性微分方程的求解
#### 常系数线性齐次微分方程
**定理：** 设$\lambda_i(i=1,2,\cdots,k)$是特征方程
$$\lambda^n+a_1\lambda^{n-1}+a_2\lambda^{n-2}+\cdots+a_{n-1}\lambda+a_n=0$$
的$m_i$重特征值，则
$$y_{ij}(t)=t^{j-1}e^{\lambda_it},\quad j=1,2,\cdots,m_i,\quad i=1,2,\cdots,k$$
是常系数线性齐次微分方程
$$y^{(n)}+a_1y^{(n-1)}+a_2y^{(n-2)}+\cdots+a_{n-1}y'+a_ny=0$$
的$n$个线性无关的解，即它们是方程的一个基本解组。
#### 线性非齐次微分方程的求解
仅以二阶线性微分方程为例。
##### 常数变易法
二阶线性微分方程的一般形式可写为
$$L[y]=y''(t)+p(t)y'(t)+q(t)y(t)=f(t)$$
其中$p(t),q(t),f(t)$在区间$(a,b)$上是连续的。
设$y_1(t)$和$y_2(t)$是对应的线性齐次微分方程的两个线性无关解，试图求得以下形式的特解
$$y_p(t)=c_1(t)y_1(t)+c_2(t)y_2(t)$$
计算$y_p$的导数
$$y_p'=[c_1(t)y_1'(t)+c_2(t)y_2'(t)]+[c_1'(t)y_1(t)+c_2'(t)y_2(t)]$$
如果令
$$c_1'(t)y_1(t)+c_2'(t)y_2(t)=0$$
则在$y_p''$中将不含$c_1(t)$和$c_2(t)$的二阶导数，进而简化问题。将$y_p$带入方程可以得到另一个限制条件为
$$c_1'(t)y_1'(t)+c_2'(t)y_2'(t)=f(t)$$
因此可以解得
$$c_1'(t)=\dfrac{-f(t)y_2(t)}{W[y_1,y_2](t)},\quad c_2'(t)=\dfrac{f(t)y_1(t)}{W[y_1,y_2](t)}$$
**定理：** 设$y_1(t)$和$y_2(t)$是对应的线性齐次微分方程的两个线性无关解，则线性非齐次微分方程的一个特解为
$$y_p(t)=-y_1(t)\int\dfrac{f(t)y_2(t)}{W[y_1,y_2](t)}\text{d}t+y_2(t)\int\dfrac{f(t)y_1(t)}{W[y_1,y_2](t)}\text{d}t$$
其中$W[y_1,y_2](t)$是$y_1(t)$和$y_2(t)$所组成的Wronsky行列式。
##### 待定系数法
**定理：** 设非齐次项$f(t)$为$P_m(t)e^{rt}\cos{kt}$或$P_m(t)e^{rt}\sin{kt}$的形式，其中$P_m(t)$为$t$的$m$次多项式，$r$和$k$为实常数。
1. 如果复数$r+\mathrm{i}k$不是ODE特征方程的根，则线性非齐次微分方程的特解可取为$$y_p=(A_0+A_1t+\cdots+A_mt^m)e^{rt}\cos{kt}+(B_0+B_1t+\cdots+B_mt^m)e^{rt}\sin{kt}$$
2. 如果复数$r+\mathrm{i}k$是ODE的$s$重根，则线性非齐次微分方程的特解可取为$$y_p=t^se^{rt}[(A_0+A_1t+\cdots+A_mt^m)\cos{kt}+(B_0+B_1t+\cdots+B_mt^m)\sin{kt}]$$
### 变系数线性微分方程的一些解法
#### Euler方程
考虑形如
$$x^n\dfrac{\text{d}^ny}{\text{d}x^n}+a_1x^{n-1}\dfrac{\text{d}^{n-1}y}{\text{d}x^{n-1}}+\cdots+a_{n-1}x\dfrac{\text{d}y}{\text{d}x}+a_ny=f(x)$$
的变系数线性微分方程，其中$a_1,\cdots,a_n$为常数。这类方程称为**Euler方程**。
在$x>0$范围内引入自变量代换$t=\ln{x}$，由复合函数求导法则
$$\dfrac{\text{d}y}{\text{d}t}=\dfrac{\text{d}y}{\text{d}x}\dfrac{\text{d}x}{\text{d}t}=x\dfrac{\text{d}y}{\text{d}x}$$
由此得
$$\dfrac{\text{d}y}{\text{d}x}=\dfrac{1}{x}\dfrac{\text{d}y}{\text{d}t}$$
进而Euler方程可以化为
$$\dfrac{\text{d}^ny}{\text{d}t^n}+b_1\dfrac{\text{d}^{n-1}y}{\text{d}t^{n-1}}+\cdots+b_{n-1}\dfrac{\text{d}y}{\text{d}t}+b_ny=f(e^t)$$
对于$x<0$仍可得到类似的结论。
根据Euler方程的特点，当$f(x)=0$时可判断方程有形如$x^r$的解，因此将其带入Euler方程可得到$r$满足代数方程
$$r(r-1)\cdots(r-n+1)+a_1r(r-1)\cdots(r-n+2)+\cdots+a_n=0$$
如果$r=r_0$是该方程的$m$重实根，那么Euler方程有$m$个实值解
$$x^{r_0},x^{r_0}\ln{|x|},\cdots,x^{r_0}\ln^{m-1}|x|$$
#### 降阶法
（只介绍二阶）
对于二阶变系数线性齐次微分方程
$$L[y]=y''+p(x)y'+q(x)y=0$$
如果已知了一个非平凡解$y_1(x)$，则可令$y=y_1u$来求解出
$$y_2(x)=y_1(x)\int\dfrac{e^{-\int p(x)\text{d}x}}{y_1^2(x)}\text{d}x$$
假设解能够写成$y=uv$的形式，那么
$$\begin{aligned}
L[y]&=L[uv]=(u''v+2u'v'+uv'')+p(u'v+uv')+quv\\
&=u''v+u'(2v'+pv)+u(v''+pv'+qv)\\
&=0
\end{aligned}$$
如果满足
$$\begin{cases}
2v'+pv=av\\
v''+pv'+qv=bv
\end{cases}$$
其中$a,b$均为常数。则可以得到
$$2p'+p^2-4q=a^2-4b$$
此时原ODE可化为
$$L[y]=v(u''+au'+bu)=0$$
因此，当确定$2p'+p^2-4q$的值为常数时，即可通过给定$a,b$来求解出$u$和$v$，进而得到ODE的解。
**例：** 求解ODE：
$$4y''+4ty+(t^2+1)y=0$$
*解：* $p(t)=t,q(t)=\dfrac{t^2+1}{4}$，因此有
$$2p'+p^2-4q=2+t^2-(t^2+1)=1$$
取$a=0,b=-\dfrac{1}{4}$，则有
$$\begin{cases}
v'+tv=0,\\
u''-\dfrac{1}{4}u=0
\end{cases}$$
进而解得ODE的通解为
$$y(t)=C_1e^{-\frac{t}{2}-\frac{t^2}{4}}+C_2e^{\frac{t}{2}-\frac{t^2}{4}}$$
#### 幂级数解法
通过展开成幂级数后比较系数的方式求解。
### Laplace变换法
见《信号与系统》。
## 微分方程的稳定性理论
### Lyapunov稳定性的基本概念
考虑微分方程组
$$\dfrac{\text{d}\mathbf{x}(t)}{\text{d}t}=\mathbf{f}(t,\mathbf{x}),\quad t\in (\beta,+\infty)$$
其中$\mathbf{f}(t,\mathbf{x})$是定义在$(\beta,+\infty)\times \mathbb{R}^n$上的函数且关于$\mathbf{x}$满足局部Lipschitz条件，$\beta$是一个给定的常数或$\beta=-\infty$；记$\mathbf{x}(t)=\boldsymbol{\varphi}(t)$是微分方程组的一个特解。
**定义（Lyapunov稳定）：** 如果对于任意给定的$\varepsilon>0$以及任意$t_0>\beta$，存在$\delta(t_0,\varepsilon)>0$，只要$\|\mathbf{x}_0-\boldsymbol{\varphi}(t_0)\|<\delta$，方程组满足初值条件$\mathbf{x}(t_0)=\mathbf{x}_0$的解$\mathbf{x}=\mathbf{x}(t;t_0,\mathbf{x}_0)$在区间$[t_0,+\infty)$上总是存在的且对于一切$t\in [t_0,+\infty)$有
$$\|\mathbf{x}(t;t_0,\mathbf{x}_0)-\boldsymbol{\varphi}(t)\|<\varepsilon$$
则称特解$\mathbf{x}=\boldsymbol{\varphi}(t)$是**Lyapunov稳定**的，简称为**稳定**的。
**定义（Lyapunov一致稳定）：** 如果对于任意给定的$\varepsilon>0$以及任意$t_0>\beta$，存在仅依赖于$\varepsilon$的$\delta(\varepsilon)>0$，只要$\|\mathbf{x}_0-\boldsymbol{\varphi}(t_0)\|<\delta$，方程组满足初值条件$\mathbf{x}(t_0)=\mathbf{x}_0$的解$\mathbf{x}=\mathbf{x}(t;t_0,\mathbf{x}_0)$在区间$[t_0,+\infty)$上总是存在的且对于一切$t\in [t_0,+\infty)$有
$$\|\mathbf{x}(t;t_0,\mathbf{x}_0)-\boldsymbol{\varphi}(t)\|<\varepsilon$$
则称特解$\mathbf{x}=\boldsymbol{\varphi}(t)$是**Lyapunov一致稳定**的，简称为**一致稳定**的。
**定义（Lyapunov不稳定）：** 如果存在某个$\varepsilon_0>0$以及$t_0>\beta$，对任何$\delta>0$，都至少存在一个满足$\|\mathbf{x}_0-\boldsymbol{\varphi}(t_0)\|<\delta$的初值$\mathbf{x}_0$，使得方程组满足初值条件$\mathbf{x}(t_0)=\mathbf{x}_0$的解$\mathbf{x}=\mathbf{x}(t;t_0,\mathbf{x}_0)$在某个$t_1>t_0$处无定义，或者在$t_1$处满足
$$\|\mathbf{x}(t_1;t_0,\mathbf{x}_0)-\boldsymbol{\varphi}(t_1)\|\geq\varepsilon_0$$
则称特解$\mathbf{x}=\boldsymbol{\varphi}(t)$是**Lyapunov不稳定**的，简称为**不稳定**的。
**定义（Lyapunov吸引）：** 如果对于任意$t_0>\beta$存在$\eta(t_0)>0$，当$\|\mathbf{x}_0-\boldsymbol{\varphi}(t_0)\|<\eta(t_0)$时满足初始条件$\mathbf{x}(t_0)=\mathbf{x}_0$的解$\mathbf{x}=\mathbf{x}(t;t_0,\mathbf{x}_0)$满足
$$\lim_{t\to +\infty}\|\mathbf{x}(t;t_0,\mathbf{x}_0)-\boldsymbol{\varphi}(t)\|=0$$
则称特解$\mathbf{x}=\boldsymbol{\varphi}(t)$是**Lyapunov吸引**的，简称为**吸引**的。
**定义（Lyapunov一致吸引）：** 如果对于任意$t_0>\beta$存在不依赖于$t_0$的$\eta>0$，当$\|\mathbf{x}_0-\boldsymbol{\varphi}(t_0)\|<\eta(t_0)$时满足初始条件$\mathbf{x}(t_0)=\mathbf{x}_0$的解$\mathbf{x}=\mathbf{x}(t;t_0,\mathbf{x}_0)$满足
$$\lim_{t\to +\infty}\|\mathbf{x}(t;t_0,\mathbf{x}_0)-\boldsymbol{\varphi}(t)\|=0$$
则称特解$\mathbf{x}=\boldsymbol{\varphi}(t)$是**Lyapunov一致吸引**的，简称为**一致吸引**的。
**定义（渐进稳定与一致渐进稳定）：** 如果特解既是稳定的又是吸引的，则称它是**渐进稳定**的；如果特解既是一致稳定的又是一致吸引的，则称它是**一致渐进稳定**的。
> 总可以通过函数变换来将特解的稳定性转化为零解的稳定性来讨论，因此后续只讨论零解的稳定性。
### 稳定性的线性近似判别法
**定义（线性近似方程）：** 将方程$\dfrac{\text{d}\mathbf{x}}{\text{d}t}=\mathbf{f}(t,\mathbf{x})$表示为如下形式：
$$\dfrac{\text{d}\mathbf{x}}{\text{d}t}=\mathbf{A}(t)\mathbf{x}+\mathbf{r}(t,\mathbf{x})$$
其中$\mathbf{A}(t)=\left[\dfrac{\partial\mathbf{f}(t,\mathbf{x})}{\partial\mathbf{x}}\right]\bigg|_{\mathbf{x}=\mathbf{0}}$是$n\times n$矩阵，$\mathbf{r}(t,\mathbf{x})$是$\mathbf{f}(t,\mathbf{x})$按$\mathbf{x}$的分量在$\mathbf{x}=\mathbf{0}$处展开时展开式中所有幂数高于一次的项的总和，即$\mathbf{r}(t,\mathbf{x})$为高阶扰动项，满足
$$\lim_{\|\mathbf{x}\|\to 0}\dfrac{\|\mathbf{r}(t,\mathbf{x})\|}{\|\mathbf{x}\|}=0$$
把线性齐次微分方程
$$\dfrac{\text{d}\mathbf{x}}{\text{d}t}=\mathbf{A}(t)\mathbf{x},\quad t>\beta$$
称为ODE的**线性近似方程**。
#### 线性微分方程组零解的稳定性
讨论线性齐次微分方程组
$$\dfrac{\text{d}\mathbf{x}}{\text{d}t}=\mathbf{A}(t)\mathbf{x},\quad t>\beta,\mathbf{x}\in\mathbb{R}^n$$
零解的稳定性，其中$\mathbf{A}(t)$是一个定义在$(\beta,+\infty)$上的连续矩阵函数。
**定理：** 设$\mathbf{\Phi}(t)$是线性齐次微分方程组的一个基解矩阵，则：
(1) 线性齐次微分方程组零解稳定的充要条件是：对任何$t_0>\beta$存在一个$K=K(t_0)>0$使得
$$\|\mathbf{\Phi}(t)\|\leq K,\quad t\geq t_0$$
(2) 线性齐次微分方程组零解一致稳定的充要条件是：存在一个$K=K(\beta)>0$使得
$$\|\mathbf{\Phi}(t)\mathbf{\Phi}^{-1}(s)\|\leq K,\quad t>s>\beta$$
(3) 线性齐次微分方程组零解渐进稳定的充要条件是：
$$\lim_{t\to+\infty}\|\mathbf{\Phi}(t)\|=0$$
(4) 线性齐次微分方程组零解一致渐进稳定的充要条件是：存在一个$M=M(\beta)>0$及$\alpha=\alpha(\beta)>0$使得
$$\|\mathbf{\Phi}(t)\mathbf{\Phi}(s)\|\leq Me^{-\alpha(t-s)},\quad t>s>\beta$$
**定理：** 假设$\mathbf{A}$是一个$n\times n$常系数矩阵，对于常系数线性微分方程组
$$\dfrac{\text{d}\mathbf{x}}{\text{d}t}=\mathbf{Ax}$$
有：
(1) 零解是（一致）渐进稳定的充要条件是$\mathbf{A}$的所有特征值的实部都是负的；
(2) 零解是（一致）稳定的充要条件是$\mathbf{A}$的特征值中没有实部为正的，且实部为0的特征值对应的Jordan块都是一阶的；
(3) 否则零解是不稳定的。
#### 非线性微分方程组零解的稳定性
**定理：** 设$\mathbf{A}(t)$为区间$(\beta,+\infty)$上的连续矩阵函数，线性齐次微分方程组$\dfrac{\text{d}\mathbf{x}}{\text{d}t}=\mathbf{A}(t)\mathbf{x}$是一致稳定的，存在常数$\delta>0$以及函数$b(t)$满足
$$\int_\beta^{+\infty}b(t)\text{d}t<+\infty$$
使得
$$\|\mathbf{r}(t,\mathbf{x})\|\leq b(t)\|\mathbf{x}\|,\quad t>\beta,\quad \|\mathbf{x}\|\leq \delta$$
则方程组
$$\dfrac{\text{d}\mathbf{x}}{\text{d}t}=\mathbf{A}(t)\mathbf{x}+\mathbf{r}(t,\mathbf{x})$$
的零解是一致稳定的。
**定理：** 设$\mathbf{A}(t)$为区间$(\beta,+\infty)$上的连续矩阵函数，线性齐次微分方程组$\dfrac{\text{d}\mathbf{x}}{\text{d}t}=\mathbf{A}(t)\mathbf{x}$是一致稳定的，存在常数$\delta>0$以及函数$b(t)$满足
$$\int_\beta^{+\infty}b(t)\text{d}t<\gamma(t-t_0)+\tau,\quad t>t_0>\beta$$
其中$\gamma=\gamma(\beta),\tau=\tau(\beta)$，使得
$$\|\mathbf{r}(t,\mathbf{x})\|\leq b(t)\|\mathbf{x}\|,\quad t>\beta,\quad \|\mathbf{x}\|\leq \delta$$
则方程组
$$\dfrac{\text{d}\mathbf{x}}{\text{d}t}=\mathbf{A}(t)\mathbf{x}+\mathbf{r}(t,\mathbf{x})$$
的零解是一致渐近稳定的。
**定理：** 设$\mathbf{A}$是一个常数矩阵，扰动项$\mathbf{r}(t,\mathbf{x})$满足条件
$$\lim_{\|\mathbf{x}\|\to 0}\dfrac{\|\mathbf{r}(t,\mathbf{x})\|}{\|\mathbf{x}\|}=0$$
关于$t>\beta$一致成立。
(1) 若矩阵$\mathbf{A}$的全部特征值的实部都是负的，则方程组
$$\dfrac{\text{d}\mathbf{x}}{\text{d}t}=\mathbf{A}(t)\mathbf{x}+\mathbf{r}(t,\mathbf{x})$$
的零解是关于$t>\beta$一致渐近稳定的；
(2) 若矩阵$\mathbf{A}$的特征值中至少有一个实部为正，则方程组的零解是不稳定的。
### 自治微分方程的Lyapunov第二方法
考虑$n$维**自治微分方程组**
$$\dfrac{\text{d}\mathbf{x}}{\text{d}t}=\mathbf{f}(\mathbf{x})$$
**定义：** 设常数$h>0$，函数$V(\mathbf{x})$在$\|\mathbf{x}\|\leq h$内连续并且关于各分量有一阶连续的偏导数。
* 如果$V(\mathbf{0})=0$且在$0<\|\mathbf{x}\|\leq h$内有$V(\mathbf{x})>0$（或$V(\mathbf{x})<0$），则称$V(\mathbf{x})$是一个**定正**（或**定负**）函数。定正函数与定负函数统称为**定号函数**；
*  如果$V(\mathbf{0})=0$且在$0<\|\mathbf{x}\|\leq h$内有$V(\mathbf{x})\geq 0$（或$V(\mathbf{x})\leq 0$），则称$V(\mathbf{x})$是一个**常正**（或**常负**）函数。定正函数与定负函数统称为**常号函数**。
**定理：** 如果存在$h>0$以及定义在$\|\mathbf{x}\|<h$内的一个定正函数$V(\mathbf{x})$，使得在$\|\mathbf{x}\|<h$内定正函数$V(\mathbf{x})$关于微分方程组的全导数
$$\dfrac{\text{d}V(\mathbf{x})}{\text{d}t}=\nabla V(\mathbf{x})\cdot\mathbf{f}(\mathbf{x})$$
是常负函数，则自治微分方程组的零解是稳定的。
**定理：** 如果存在$h>0$以及定义在$\|\mathbf{x}\|<h$内的一个定正函数$V(\mathbf{x})$，使得在$\|\mathbf{x}\|<h$内定正函数$V(\mathbf{x})$关于微分方程组的全导数
$$\dfrac{\text{d}V(\mathbf{x})}{\text{d}t}=\nabla V(\mathbf{x})\cdot\mathbf{f}(\mathbf{x})$$
是定负函数，则自治微分方程组的零解是渐近稳定的。
**定理：** 如果存在一个标量函数$V(\mathbf{x})$和原点某邻域中的一个开子区域$\mathcal{N}$使得
(1) $V(\mathbf{x})$在$\mathcal{N}$内连续可微；
(2) $\mathcal{N}$的边界$\partial\mathcal{N}$通过原点，且存在$\delta>0$，记$\mathcal{B}_\delta=\{\mathbf{x}\mid \|\mathbf{x}\|\leq\delta\}$使得
$$V(\mathbf{x})|_{\mathbf{x}\in\partial\mathcal{N}\cap\mathcal{B}_\delta}=0$$
(3) 在$\mathcal{N}\cap\mathcal{B}_\delta$内$V(\mathbf{x})$和全导数$\dfrac{\text{d}V(\mathbf{x})}{\text{d}t}$都是定正函数。
则自治微分方程组的零解是不稳定的。
## 微分方程的几何理论
### 自治微分方程组的相空间与轨线
考虑$n$维自治微分方程组
$$\dfrac{\text{d}\mathbf{x}}{\text{d}t}=\mathbf{f}(\mathbf{x})$$
如果向量函数$\mathbf{f}(\mathbf{x})$满足解的存在唯一性条件，则满足初始条件$\mathbf{x}(t_0)=\mathbf{x}_0$的自治微分方程组存在唯一解，记为$\mathbf{x}=\boldsymbol{\varphi}(t;t_0,\mathbf{x}_0)$。
从动力学观点来看，$\mathbf{x}$可以看成一个质点$M$在空间$\mathbb{R}^n$中的位置变量，$\mathbf{f}(\mathbf{x})$可以看成空间$\mathbb{R}^n$中的一个速度场，那么自治微分方程组可以理解为质点$M$在速度场作用下的运动。把质点$M$所在的空间称为**相空间**，把$(t,\mathbf{x})$所在的空间称为**增广相空间**，把以$t$为参数且规定沿着$t$增加方向为正方向的曲线$\mathbf{x}=\boldsymbol{\varphi}(t;t_0,\mathbf{x}_0)$（即质点$M$的运动轨迹）称为自治微分方程组的**轨线**，标明所有轨线位置关系的拓扑结构图称为自治微分方程组的**相图**。轨线是自治微分方程组的积分曲线在相空间上的投影曲线。
### 平面线性自治微分方程组的奇点分析
考虑线性微分方程组
$$\begin{cases}
\dfrac{\text{d}x}{\text{d}t}=ax+by,\\
\dfrac{\text{d}y}{\text{d}t}=cx+dy,
\end{cases}$$
其中$a,b,c,d$是常数。记
$$\mathbf{Q}=\begin{bmatrix}
a & b\\
c & d
\end{bmatrix}$$
当原点$(0,0)$是线性微分方程组的唯一奇点，即$|\mathbf{Q}|\neq 0$时，称原点$(0,0)$是方程组的**初等奇点**，这时方程组称为**非退化线性微分方程组**；当$|\mathbf{Q}|=0$时，称原点$(0,0)$是方程组的**高等奇点**，方程组称为**退化线性微分方程组**。
#### 非退化线性微分方程组的轨线
记$\mathbf{Q}$的两个特征值分别为$\lambda_1,\lambda_2$。
1. $\lambda_1,\lambda_2$为两个不相等实根
	(1) 对于同号实根的情况，奇点是结点。把直线方程$y=kx$带入方程组可以得到$k=\dfrac{c+dk}{a+bk}$，求出两个实数$k_1,k_2$（$k_2$允许取$+\infty$），进而确定四条直轨线的位置。在二者之间的部分，任取射线$y=kx$，轨线与射线的交点处斜率为$\dfrac{c+dk}{a+bk}$，通过比较斜率的大小关系判断到底与哪条直线相切。
	(2) 对于异号实根的情况，奇点是鞍点。四条直轨线中两条趋于原点，两条离开原点，在其中一条止规线上任取一点计算出该点的切向量，即可确定出这条直轨线的正向。
2. $\lambda_1,\lambda_2$为两个相等实根
	可能是星形结点也可能是退化结点。若有无穷多条直轨线，则是星形结点；若只有一个$y=k_0x$，则是退化结点。对于直轨线以外的点$(x_0,y_0)$，如果$\left(x\dfrac{\text{d}y}{\text{d}t}-y\dfrac{\text{d}x}{\text{d}t}\right)\bigg|_{(x_0,y_0)}>0$，则轨线正向是逆时针方向，否则是顺时针方向。
3.   $\lambda_1,\lambda_2$为两个共轭复根
	特征值实部为0时，奇点是中心；实部不为0时，奇点是焦点。旋转方向通过$\left(x\dfrac{\text{d}y}{\text{d}t}-y\dfrac{\text{d}x}{\text{d}t}\right)\bigg|_{(x_0,y_0)}$来判别。
#### 退化线性微分方程组的轨线
对于只有一个零特征值的情况，找到直轨线后，直轨线上的所有点都是奇点。
对于两个零特征值的情况，所有轨线与直轨线平行。